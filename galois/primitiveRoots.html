<!DOCTYPE html>
<meta charset="utf-8">
<html lang="en-us">
  <head>
    <link href="/galois/primitive-roots.css" rel="stylesheet" type="text/css" /> 
    <script src="/colorSummaries/js/d3.v4.min.js" type="text/javascript"></script>
    <script src="/explorables/js/d3-scale-chromatic.v1.min.js"></script>
    <script src='/galois/helpers.js' type='text/javascript'></script>
    <script src='/colorSummaries/js/widget.v3.3.js' type='text/javascript'></script>
  </head>

  <div class='din-title'>primitive roots modulo n</div>
  <main role="main">
    <div class='grid-container'></div>
    <div class='group-controls'>
      <div class='group_widgets'></div>
    </div>
  </main>

  <script>
    const controlbox_width = 350,
         controlbox_height = 350,
         n_grid_x = 24,
         n_grid_y = 24

    var controls = d3.selectAll(".group-controls").append("svg")
      .attr("width", controlbox_width)
      .attr("height", controlbox_height)
      .attr("class", "group_widgets")

// radios
var g = widget.grid(controlbox_width,controlbox_height,n_grid_x,n_grid_y);

const mu = [0.75,1.0,1.25,1.5,1.75,2.0,3.0];
var radioblock1 = g.block({x0:11,y0:7,width:5,height:0});
var radioblock2 = g.block({x0:12,y0:4,width:11,height:0});
var mustr = mu.map(function(d){return ""+d});
    
var def_mu = 1.0; 

var c1 = {id:"ns", name:"# of Walkers", choices: ["1","5", "10", "25"], value:2};
var c2 = {id:"mus", name:"Exponent", choices: mustr, value:1};
var mustr = mu.map(function(d){return ""+d});
var def_mu = 1.0; 
var radios1 = [
  widget.radio(c1).size(radioblock1.w()).label("bottom")
  .shape("rect").fontSize(16).orientation("horizontal").update(function(){erase();draw()})
]

var radios2 = [
  widget.radio(c2).size(radioblock2.w()).label("bottom")
  .shape("circ").fontSize(16).orientation("horizontal").update(resetsystem)
]

var rad1 = controls.selectAll(".radio .r1").data(radios1).enter().append(widget.radioElement)
  .attr("transform",function(d,i){return "translate("+radioblock1.x(0)+","+radioblock1.y(0)+")"});  



    var playbutton = [
     widget.button(choices).size(g.x(7)).symbolSize(0.6*g.x(7)).update(runpause)
    ]

    var playblock = g.block({x0:5,y0:19,width:0,height:0});

    controls.selectAll(".button .playbutton").data(playbutton).enter()
            .append(widget.radio)
            // .attr("transform", function(d,i){
       // return "translate("+playblock.x(0)+","+playblock.y(i)+")"
     // });

    var tm; // initialize timer
    function runpause(d){
      d.value == 1 ? tm = setInterval(runBlink, 50) : clearInterval(tm)
    }

    function resetsystem(){
      pb.transition().style("opacity",null).style("pointer-events","all")
      tick = 0;
      erase()
      walks = [];

      d3.range(M[M.length-1]).forEach(function(x,i){
        walks.push({ix:i,tr:[initial_point]})
      })

      d3.shuffle(walks)
      X.domain(box(T0))
      Y.domain(box(T0))
      draw()
    }


    const gSize = 13
    const width = 500
    const k = 0.9

    var prims = primitives(gSize)
    var pLen = Math.sqrt(prims.length)
    var cSize = width / pLen

    var container = 
      d3.selectAll('.grid-container').append('svg')
      .attr('height', width+100).attr('width', width+100)

    var gridContainer = container.append('rect')
      .attr('height', width+10*k)
      .attr('width', width+10*k)
      .attr('class', 'grid')

    var groupContainer = container.append("g")
    var group = groupContainer.selectAll('rect')
      .data(prims).enter().append('rect')
      .attr('transform', 'translate(6,6)')
      .attr("fill", d => d3.interpolateSpectral(d/gSize) )
      .attr('x', (d, i) => cSize * mod(i, pLen) )
      .attr('y', (d, i) => cSize * div(i, pLen) )
      .attr("width", d => cSize * k)
      .attr("height", d => cSize * k)
  </script>
</html>
