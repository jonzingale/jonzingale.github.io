<!DOCTYPE html>
<meta charset="utf-8">
<html lang="en-us">
  <head>
    <link href="/maps/hiking.css" rel="stylesheet" type="text/css" /> 
    <script src="/js/d3.v4.min.js" type="text/javascript"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="/js/d3-scale-chromatic.v1.min.js"></script>
    <script src="/js/helpers.js"></script>
  </head>
  <div class='sfi-title'>SANTA FE INSTITUTE</div>
  <div class='title'>Ann Nitze Hiking Trails</div>
  <main role="main">
    <div class='map-img'>
      <path class='trace' />
    </div>

    <div class='footer'></div>
  </main>

  <script>
    var lineGenerator = d3.line().curve(d3.curveCardinal);
    var accent = d3.scaleOrdinal(d3.schemeCategory10)

    // var accent = d3.scaleOrdinal(['#a6611a', '#dfc27d', '#80cdc1', '#018571']) // OK
    var accent = d3.scaleOrdinal(['#a6611a', '#dfc27d', '#80cdc1', '#1f77b4']) // OK Tim's Blue

    var container = d3.selectAll('.map-img').selectAll('.trace')
      .append('svg').attr('height', 660).attr('width', 740) // cropped
      .attr('transform','translate(-145)')
      // .attr('transform','translate(50) rotate(-90)')

    // Contours
    const contourData = [
      [[304,7],[307,46],[321,80],[338,114],[365,150],[406,169],[432,151],[443,124],[455,101],[472,89],[495,79],[511,65],[523,44],[541,20],[554,6]],
      [[327,9],[343,66],[368,97],[394,112],[415,107],[432,88],[452,73],[476,62],[504,42],[519,22],[530,9]],

      // 7560 ft
      [[356,7],[368,41],[385,68],[406,72],[428,59],[444,48],[469,39],[491,26],[508,5]],
      [[383,7],[395,32],[411,37],[434,29],[460,19],[482,5]],
      [[281,7],[283,53],[308,116],[328,155],[365,188],[386,218],[383,245],[375,285],[377,312],[378,342],[380,368],[390,379],[403,371],[417,338],[427,296],[429,255],[432,221],[445,192],[455,170],[462,142],[467,122],[486,111],[509,102],[521,89],[530,69],[541,43],[561,23],[577,8]],
      [[260,7],[256,40],[260,68],[270,91],[278,110],[289,130],[298,148],[308,172],[331,200],[350,229],[350,256],[347,287],[348,306],[353,330],[350,357],[352,386],[363,407],[387,408],[411,386],[430,345],[442,306],[449,275],[455,242],[464,206],[474,173],[481,144],[494,132],[514,121],[528,111],[541,87],[552,59],[574,33],[596,7]],
      [[236,7],[228,42],[236,76],[248,108],[253,126],[264,152],[273,183],[290,205],[309,234],[319,256],[315,289],[318,310],[322,330],[320,351],[317,375],[324,399],[337,420],[361,434],[395,425],[416,402],[431,377],[442,344],[451,318],[463,281],[468,250],[481,210],[489,185],[493,164],[503,150],[523,133],[545,110],[563,80],[579,50],[599,26],[612,7]],
      [[213,6],[207,47],[218,86],[231,127],[245,172],[257,202],[279,229],[292,257],[287,283],[288,310],[295,334],[290,364],[295,403],[310,421],[339,455],[376,460],[401,442],[425,413],[446,368],[468,300],[477,267],[491,222],[503,187],[511,167],[530,148],[555,124],[567,108],[582,81],[600,50],[615,28],[627,7]],
      [[195,7],[189,41],[194,82],[206,119],[215,157],[222,187],[238,210],[252,225],[264,241],[266,258],[258,284],[259,303],[266,334],[267,349],[264,372],[264,395],[278,422],[293,443],[305,460],[329,485],[350,492],[377,485],[397,471],[423,444],[440,414],[456,370],[473,317],[486,282],[507,222],[532,165],[547,155],[569,149],[586,135],[598,123],[606,119],[604,129],[596,157],[575,203],[563,244],[555,276],[545,332],[544,355],[529,402],[523,439],[516,457],[501,492],[493,518],[487,540],[475,569],[452,596],[440,624]],

      // 7400 ft
      [[172,6],[169,35],[173,81],[183,120],[190,152],[193,181],[195,195],[207,214],[227,236],[238,251],[238,266],[232,288],[228,303],[230,327],[238,347],[239,369],[237,397],[247,437],[263,466],[267,478],[280,513],[291,535],[311,543],[339,535],[360,522],[387,504],[428,465],[446,434],[463,392],[477,347],[487,320],[501,306],[510,295],[518,281],[523,285],[527,303],[529,322],[522,362],[513,394],[508,417],[504,444],[495,465],[484,487],[468,522],[459,541],[449,554],[433,571],[420,587],[414,599],[409,632]],
      [[150,7],[148,34],[149,46],[155,95],[171,156],[178,196],[189,218],[205,245],[210,259],[208,278],[202,299],[199,323],[203,348],[206,365],[203,394],[202,419],[214,451],[225,473],[227,489],[226,514],[221,543],[217,566],[217,580],[228,589],[261,589],[288,584],[329,585],[349,579],[373,556],[392,542],[409,532],[423,522],[429,522],[427,533],[413,549],[403,563],[392,583],[384,610],[381,623]],

      // 7440 ft (right of institute)
      [[671,6],[667,35],[654,65],[637,102],[619,141],[597,193],[582,227],[570,272],[570,316],[578,343],[576,361],[559,380],[548,404],[542,428],[537,456],[524,484],[515,512],[508,540],[500,576],[487,600],[476,622]],
      [[693,6],[679,43],[667,75],[645,117],[604,215],[587,278],[596,318],[610,338],[614,353],[595,372],[576,388],[562,419],[554,456],[539,494],[531,541],[533,568],[528,587],[516,607],[505,623]],
      [[706,6],[689,43],[685,75],[678,92],[659,121],[642,156],[629,197],[618,239],[616,277],[625,307],[640,331],[645,345],[632,368],[610,386],[592,404],[577,437],[563,476],[552,523],[558,571],[548,609],[539,623]],
      [[727,7],[706,33],[700,57],[697,87],[688,105],[667,140],[655,169],[636,222],[630,269],[643,306],[660,330],[662,352],[649,372],[625,401],[605,422],[590,456],[582,476],[572,502],[571,526],[577,558],[582,586],[567,622]],
      [[755,7],[730,29],[720,48],[710,90],[691,129],[666,179],[653,220],[648,262],[653,287],[673,319],[685,339],[679,357],[660,380],[647,402],[620,435],[605,468],[594,508],[600,547],[604,578],[599,607],[590,623]],
      [[785,5],[754,30],[736,48],[729,70],[720,102],[714,118],[698,142],[683,173],[672,206],[665,236],[665,268],[676,297],[693,319],[701,337],[693,358],[672,383],[661,404],[649,421],[634,441],[622,462],[615,490],[617,514],[621,545],[626,566],[625,580],[617,601],[607,624]],

      // 7550 ft
      [[801,11],[764,41],[746,70],[736,91],[724,122],[709,146],[694,173],[683,209],[680,241],[684,281],[701,310],[717,334],[704,360],[682,391],[658,428],[645,459],[634,489],[637,520],[644,561],[636,591],[622,623]],
      [[642,623],[660,560],[664,520],[661,468],[676,427],[692,407],[697,391],[711,374],[728,351],[726,323],[706,295],[695,262],[695,226],[701,188],[713,160],[731,132],[747,100],[747,99],[770,61],[801,28]],
      // 7600 ft
      [[801,44],[784,64],[766,90],[758,108],[743,133],[723,169],[716,197],[712,237],[716,277],[732,306],[744,339],[730,371],[713,394],[697,426],[686,470],[685,506],[673,560],[661,611],[659,624]],
      [[801,62],[773,106],[760,131],[742,163],[732,190],[727,223],[731,259],[740,287],[754,305],[763,334],[753,368],[736,387],[725,409],[713,448],[710,483],[705,511],[698,538],[693,572],[694,591],[721,591],[755,578],[787,552],[800,541]],
      // 7640 ft
      [[801,85],[764,149],[744,194],[740,221],[744,246],[760,277],[786,325],[801,330]],
      [[801,111],[776,153],[758,193],[753,218],[769,265],[782,287],[801,302]],
      // 7680 ft
      [[801,131],[778,175],[768,203],[768,222],[778,250],[795,274],[800,277]],
      [[800,579],[771,600],[728,625]],
      [[800,604],[777,624]],
      [[800,156],[788,182],[785,207],[789,230],[801,239]],
      [[801,377],[788,393],[784,407],[786,418],[801,431]],
      // 7657 ft
      [[800,464],[790,453],[772,445],[756,444],[738,454],[729,473],[725,502],[722,525],[719,549],[723,561],[734,565],[752,558],[770,542],[784,529],[800,506]],
      ]

    var contourContainer = container.append("g").attr('class','contours')
    var contours = contourContainer.selectAll('.contours')
      .data(contourData).enter().append('path')
      .attr('d', function(d){ return lineGenerator(d)})


    const parkingData = [
      {t: "translate(291, 354) rotate(-69)", w: 12, h: 6.5},
      {t: "translate(339, 193) rotate(50)", w: 22, h: 10},
      {t: "translate(359, 175) rotate(42)", w: 22, h: 10},
    ]

    // Campus Buildings
    var parkingContainer = container.append("g").attr('class','parking-lots')
    var parking = parkingContainer.selectAll('.parking-lots')
      .data(parkingData).enter().append('rect')
      .attr("transform", function(d) { return d.t })
      .attr("width", function(d) { return d.w })
      .attr("height", function(d) { return d.h })


    // Roads
    const roadData = [
      // mainhouse turnabout
      [[395,215],[393,218],[394,226],[395,234],[402,242],[415,246],[422,235],[422,224],[418,217],[406,213],[395,215]],
      // gatehouse turnabout
      [[266,553],[261,547],[249,543],[242,546],[238,557],[241,568],[252,575],[263,570],[266,570]],
      //driveway
      [[275,609],[266,567],[270,540],[283,521],[304,504],[312,479],[309,448],[294,401],[287,372],[293,349],[311,301],[327,270],[342,250],[352,238],[354,224],[339,203],[332,190],[336,176],[352,176],[366,187],[394,217]],
      //hydepark
      [[258,623], [321,568], [405,492], [456,431], [490,317], [518,219],[565,128], [608,62], [637,6]],
      // canada del sur
      [[321,570],[371,616],[408,632],[447,615],[473,590],[504,563],[530,552],[558,550]],
      // canada del ancha
      [[569,622],[553,526],[551,489],[566,430],[568,409],[583,331],[587,284],[594,233],[608,190], [619,160],[631,134],[640,125],[650,128],[653,142],[648,166],[645,199],[648,225],[661,245],[680,268],[701,289],[722,311],[727,331],[716,364],[704,395],[694,426],[689,456],[679,512],[672,556],[664,604],[661,623]],
      // canada del norte
      [[508,252],[538,260],[549,261],[566,251],[579,245],[592,240]],
      [[690,455],[713,430],[729,412],[741,405],[763,401],[772,401]],
      // vista canada ancha
      [[712,572],[738,557],[751,539],[759,511],[765,483],[767,460],[772,406],[774,397],[788,379],[799,363],[806,346],[805,327],[792,307],[786,286],[787,269],[781,249],[777,227]]
      ]

    var roadContainer = container.append("g").attr('class','roads')
    var roads = roadContainer.selectAll('.roads')
      .data(roadData).enter().append('path')
      .attr('d', function(d){ return lineGenerator(d)})

    const trailColors = [1,1,2,2,3,3,0]

    const trailData = [
        // gatehouse
        [[366,294],[350,316],[337,324],[322,333],[311,348],[312,369],[316,411],[324,445],[339,474],[358,483],[365,487],[361,494],[328,523],[312,526],[290,516]],
        // 1/2 way to gatehouse
        [[299,351],[310,352]],
        // moderate bridge to handicap
        [[420,175],[431,174],[439,170],[446,172],[454,170],[460,168]],
        // moderate path to annex
        [[365,215],[360,203],[339,180],[325,172],[316,177],[305,181],[295,179],[290,174],[286,163],[283,152],[282,146],[284,143],[291,147],[297,148],[303,142],[309,135],[315,133],[319,130],[322,123],[327,127],[336,132],[339,127],[342,124],[351,131],[358,131],[366,130],[374,127],[385,125],[390,127],[398,130],[404,130],[411,133],[419,133],[425,148],[426,164],[420,175],[409,179],[395,183],[388,191],[390,201],[385,207]],
        // challenging body
        [[361,104],[349,92],[344,104],[333,90],[326,106],[315,94],[309,105],[294,95],[284,111],[269,98],[258,117],[231,110],[223,152],[230,192],[245,214],[261,235],[266,254],[260,278],[257,310],[263,327],[285,323],[293,310],[304,287],[311,265],[326,238],[329,224],[322,205],[306,181]],
        // challenging upper right
        [[367,129],[365,113], [362,103],[370,99],[377,106],[386,105],[392,105],[398,106],[412,111],[419,112],[427,103],[433,109],[441,93],[453,105],[459,95],[466,92],[472,97],[480,78],[490,89],[490,102],[467,144],[460,169]],
        // handicap access
        [[460,168],[450,205],[443,230],[439,257],[437,286],[432,307],[427,328],[416,356],[407,375],[398,384],[383,384],[375,375],[373,340],[373,323],[370,307],[365,291],[356,276],[357,263],[368,248],[379,230],[382,218],[375,214],[360,217],[353,223]],
    ]

    var trailContainer = container.append("g").attr('class','trails')
    var trails = trailContainer.selectAll('.trails')
      .data(trailData).enter().append('path')
      .attr('d', function(d){ return lineGenerator(d)})
      .attr('stroke', function(d, i){ return accent(trailColors[i]/4) })


      const buildingData = [
        // heliotown II
        {t: "translate(356, 320) rotate(-55)", w: 8, h: 6},
        // gatehouse
        {t: "translate(250, 528) rotate(-45)", w: 16, h: 16},
        {t: "translate(245, 528) rotate(-45)", w: 16, h: 10},
        // annex
        {t: "translate(392, 198) rotate(-20)", w: 15, h: 8},
        {t: "translate(406, 199) rotate(-20)", w: 9, h: 9},
        // main building
        {t: "translate(368, 272) rotate(-50)", w: 40, h: 20},
        {t: "translate(394, 293) rotate(-50)", w: 45, h: 10},
        {t: "translate(390, 313) rotate(-50)", w: 10, h: 10},
        {t: "translate(389, 333) rotate(-50)", w: 10, h: 8.5},
        {t: "translate(392, 270) rotate(40)", w: 17, h: 12},
        {t: "translate(405, 255) rotate(40)", w: 17, h: 12},
        {t: "translate(390, 288) rotate(40)", w: 27, h: 12},
        {t: "translate(390, 308) rotate(40)", w: 25, h: 12},
        {t: "translate(390, 328) rotate(40)", w: 23, h: 12},
      ]

      // Campus Buildings
      var buildingContainer = container.append("g")
      var buildings = buildingContainer.selectAll('rect')
        .data(buildingData).enter().append('rect')
        .attr("transform", function(d) { return d.t })
        .attr("width", function(d) { return d.w })
        .attr("height", function(d) { return d.h })
        .attr("fill", "#333")

      var elevationData = [
        {x: 388, y: 82,  t: '7560 ft'},
        {x: 290, y: 555, t: '7400 ft'}
      ]

      var elevationContainer = container.append('g')
      var elevations = elevationContainer.selectAll('text')
      .data(elevationData).enter().append('text')
      .attr('x', function(d) { return d.x })
      .attr('y', function(d) { return d.y })
      .text(function(d) { return d.t })
      .attr("font-family", "sans-serif")
      .attr("font-size", "9px")
      .attr("fill", "black");

    // Map Key
    container
      .append('rect')
      .attr("transform", function(d) { return 'translate(400,443)'})
      .attr('fill','white')
      .attr("width", function(d) { return 130 })
      .attr("height", function(d) { return 40 })

    var mapKeyContainer = container.append("g").attr('class','map-key')

    mapKeyContainer
      .append('rect').attr('class','key-rect')
      .attr("transform", 'translate(410,480)')
      .attr('rx', 6)
      .attr('ry', 6)
      .attr("width", function(d) { return 310 })
      .attr("height", function(d) { return 130 })

    mapKeyContainer
      .append('text').attr('class','key-title')
      .attr('x', 410)
      .attr('y', 470)
      .text('Path Key')
      .attr("font-size", "30px")
      .attr("fill", "black")

    const keyData = [
      { text: 'Handicap Access', dist: "0.30 miles"},
      { text: 'Gatehouse Path', dist: "0.21 miles"},
      { text: 'Moderate', dist: "0.22 miles"},
      { text: 'Challenging', dist: "0.66 miles"},
    ]

    var keyRows = mapKeyContainer.selectAll('key-data')

    var keyText = keyRows
      .data(keyData).enter()
      .append('text')
      .attr('class','key-text')
      .attr('x', 450)
      .attr('y', function(d, i) { return i*30 + 506 })
      .attr("font-size", "18px")
      .attr("fill", "black")
      .text(function(d) { return d.text})

      var keyDist = keyRows
        .data(keyData).enter()
        .append('text')
        .attr('class','key-text')
        .attr('x', 610)
        .attr('y', function(d, i) { return i*30 + 506 })
        .attr("font-size", "18px")
        .attr("fill", "black")
        .text(function(d) { return d.dist})

    var keyCircles = keyRows
      .data(keyData).enter()
        .append("circle")
        .attr("transform", 'translate(410,480)')
        .attr("cx", 20).attr("r", 10)
        .attr("cy", function(d, i) { return i*30 + 20 })
        .attr('fill', function(d,i) { return accent(i/4) })

    // compass
    const compassData = [
      {x1: 710, y1: 70, x2: 710, y2: 140},
      {x1: 710, y1: 70, x2: 705, y2: 100},
    ]

    var compass = container.append('g').attr('class','compass')
    compass.append('text')
    .attr("font-size", "40px")
    .attr('x', 670)
    .attr('y', 140)
    .text('N')

    compass.selectAll('.compass')
      .data(compassData).enter().append('line')
      .attr('stroke-width', '4px')
      .attr('x1', function(d) { return d.x1 })
      .attr('y1', function(d) { return d.y1 })
      .attr('x2', function(d) { return d.x2 })
      .attr('y2', function(d) { return d.y2 })


    var accumData = []
    container.on("click", function() {
      accumData.push(d3.mouse(this))
      console.log(JSON.stringify(accumData))
    })

  </script>
</html>
